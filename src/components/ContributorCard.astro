---
import type { ProcessedContributor } from '../utils/processContributors';

interface Props {
  contributor: ProcessedContributor;
}

const { contributor } = Astro.props;

// Format commit date
const formatCommitDate = (date: string) => {
  return new Date(date).toLocaleDateString('en-US', {
    year: 'numeric',
    month: 'short',
    day: 'numeric'
  });
};
---

<div class="group bg-white rounded-xl p-3 shadow-sm hover:shadow-lg transition-all duration-300 hover:-translate-y-1 border border-gray-100/80">
  <!-- Header: Avatar + Name -->
  <div class="flex items-start gap-2.5 mb-2">
    <img
      src={contributor.avatarUrl}
      alt={contributor.login}
      class="w-10 h-10 rounded-full ring-1 ring-gray-200 shadow-sm"
      loading="lazy"
    />
    <div class="flex-1 min-w-0">
      <h3 class="text-sm font-bold text-gray-900 truncate">
        {contributor.name || contributor.login}
      </h3>
      <a
        href={contributor.profileUrl}
        target="_blank"
        rel="noopener noreferrer"
        class="text-xs text-blue-600 hover:text-blue-700"
      >
        @{contributor.login}
      </a>
    </div>
  </div>

  <!-- Stats -->
  <div class="flex items-center gap-2 mb-2 text-xs">
    <span class="flex items-center gap-1 px-2 py-1 bg-green-50 rounded-full">
      <strong class="text-green-700">{contributor.totalContributions}</strong>
      <span class="text-green-600">commits</span>
    </span>
    <span class="flex items-center gap-1 px-2 py-1 bg-blue-50 rounded-full">
      <strong class="text-blue-700">{contributor.repoCount}</strong>
      <span class="text-blue-600">repos</span>
    </span>
  </div>

  <!-- Profile Info (simplified) -->
  <div class="space-y-1 text-xs text-gray-500">
    {contributor.location && (
      <div class="flex items-center gap-1 truncate">
        <span>üìç</span>
        <span class="truncate">{contributor.location}</span>
      </div>
    )}
  </div>

  <!-- Repositories contributed to (compact) -->
  {contributor.repositories && contributor.repositories.length > 0 && (
    <div class="pt-2 mt-2 border-t border-gray-100">
      <div class="flex flex-wrap gap-1">
        {contributor.repositories.slice(0, 3).map((repo) => (
          <a
            href={`https://github.com/DevExpGbb/${repo}`}
            target="_blank"
            rel="noopener noreferrer"
            class="inline-flex items-center px-1.5 py-0.5 text-xs bg-blue-50 text-blue-700 rounded hover:bg-blue-100 transition-colors"
          >
            {repo}
          </a>
        ))}
        {contributor.repositories.length > 3 && (
          <span class="inline-flex items-center px-1.5 py-0.5 text-xs bg-gray-100 text-gray-600 rounded">
            +{contributor.repositories.length - 3}
          </span>
        )}
      </div>
    </div>
  )}
</div>
